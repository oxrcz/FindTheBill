<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FindTheBill</title>
</head>
<body>
    <h1>Track a Bill</h1>
    <form id="billForm">
        <label for="serialNumber">Bill Serial Number:</label><br>
        <input type="text" id="serialNumber" name="serialNumber" required><br><br>
        
        <label for="date">Tracking Date (YYYY-MM-DD):</label><br>
        <input type="date" id="date" name="date" required><br><br>
        
        <button type="submit">Track Bill</button>
    </form>

    <script>
        // Function to get the user's location via IP (using ipinfo.io API)
        async function getLocation() {
            const response = await fetch('https://ipinfo.io/json?token=YOUR_API_KEY');
            const data = await response.json();
            const [city, state] = data.region.split(', ');
            return { city, state };
        }

        document.getElementById('billForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const serialNumber = document.getElementById('serialNumber').value;
            const date = document.getElementById('date').value;

            // Get the location based on the IP
            const location = await getLocation();
            const city = location.city;
            const state = location.state;

            // Send the tracking data to the backend
            const response = await fetch('/api/track-bill', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ serialNumber, city, state, date })
            });

            const data = await response.json();
            
            if (data.message) {
                alert(data.message);
            } else {
                alert('Error tracking bill');
            }
        });
    </script>
</body>
</html>
